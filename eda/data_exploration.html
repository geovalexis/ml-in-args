<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<style type="text/css">
@font-face {
font-family: octicons-link;
src: url(data:font/woff;charset=utf-8;base64,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) format('woff');
}
body {
-webkit-text-size-adjust: 100%;
text-size-adjust: 100%;
color: #333;
font-family: "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
font-size: 16px;
line-height: 1.6;
word-wrap: break-word;
}
a {
background-color: transparent;
}
a:active,
a:hover {
outline: 0;
}
strong {
font-weight: bold;
}
h1 {
font-size: 2em;
margin: 0.67em 0;
}
img {
border: 0;
}
hr {
box-sizing: content-box;
height: 0;
}
pre {
overflow: auto;
}
code,
kbd,
pre {
font-family: monospace, monospace;
font-size: 1em;
}
input {
color: inherit;
font: inherit;
margin: 0;
}
html input[disabled] {
cursor: default;
}
input {
line-height: normal;
}
input[type="checkbox"] {
box-sizing: border-box;
padding: 0;
}
table {
border-collapse: collapse;
border-spacing: 0;
}
td,
th {
padding: 0;
}
* {
box-sizing: border-box;
}
input {
font: 13px / 1.4 Helvetica, arial, nimbussansl, liberationsans, freesans, clean, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}
a {
color: #4078c0;
text-decoration: none;
}
a:hover,
a:active {
text-decoration: underline;
}
hr {
height: 0;
margin: 15px 0;
overflow: hidden;
background: transparent;
border: 0;
border-bottom: 1px solid #ddd;
}
hr:before {
display: table;
content: "";
}
hr:after {
display: table;
clear: both;
content: "";
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 15px;
margin-bottom: 15px;
line-height: 1.1;
}
h1 {
font-size: 30px;
}
h2 {
font-size: 21px;
}
h3 {
font-size: 16px;
}
h4 {
font-size: 14px;
}
h5 {
font-size: 12px;
}
h6 {
font-size: 11px;
}
blockquote {
margin: 0;
}
ul,
ol {
padding: 0;
margin-top: 0;
margin-bottom: 0;
}
ol ol,
ul ol {
list-style-type: lower-roman;
}
ul ul ol,
ul ol ol,
ol ul ol,
ol ol ol {
list-style-type: lower-alpha;
}
dd {
margin-left: 0;
}
code {
font-family: Consolas, "Liberation Mono", Menlo, Courier, monospace;
font-size: 12px;
}
pre {
margin-top: 0;
margin-bottom: 0;
font: 12px Consolas, "Liberation Mono", Menlo, Courier, monospace;
}
.select::-ms-expand {
opacity: 0;
}
.octicon {
font: normal normal normal 16px/1 octicons-link;
display: inline-block;
text-decoration: none;
text-rendering: auto;
-webkit-font-smoothing: antialiased;
-moz-osx-font-smoothing: grayscale;
-webkit-user-select: none;
-moz-user-select: none;
-ms-user-select: none;
user-select: none;
}
.octicon-link:before {
content: '\f05c';
}
.markdown-body:before {
display: table;
content: "";
}
.markdown-body:after {
display: table;
clear: both;
content: "";
}
.markdown-body>*:first-child {
margin-top: 0 !important;
}
.markdown-body>*:last-child {
margin-bottom: 0 !important;
}
a:not([href]) {
color: inherit;
text-decoration: none;
}
.anchor {
display: inline-block;
padding-right: 2px;
margin-left: -18px;
}
.anchor:focus {
outline: none;
}
h1,
h2,
h3,
h4,
h5,
h6 {
margin-top: 1em;
margin-bottom: 16px;
font-weight: bold;
line-height: 1.4;
}
h1 .octicon-link,
h2 .octicon-link,
h3 .octicon-link,
h4 .octicon-link,
h5 .octicon-link,
h6 .octicon-link {
color: #000;
vertical-align: middle;
visibility: hidden;
}
h1:hover .anchor,
h2:hover .anchor,
h3:hover .anchor,
h4:hover .anchor,
h5:hover .anchor,
h6:hover .anchor {
text-decoration: none;
}
h1:hover .anchor .octicon-link,
h2:hover .anchor .octicon-link,
h3:hover .anchor .octicon-link,
h4:hover .anchor .octicon-link,
h5:hover .anchor .octicon-link,
h6:hover .anchor .octicon-link {
visibility: visible;
}
h1 {
padding-bottom: 0.3em;
font-size: 2.25em;
line-height: 1.2;
border-bottom: 1px solid #eee;
}
h1 .anchor {
line-height: 1;
}
h2 {
padding-bottom: 0.3em;
font-size: 1.75em;
line-height: 1.225;
border-bottom: 1px solid #eee;
}
h2 .anchor {
line-height: 1;
}
h3 {
font-size: 1.5em;
line-height: 1.43;
}
h3 .anchor {
line-height: 1.2;
}
h4 {
font-size: 1.25em;
}
h4 .anchor {
line-height: 1.2;
}
h5 {
font-size: 1em;
}
h5 .anchor {
line-height: 1.1;
}
h6 {
font-size: 1em;
color: #777;
}
h6 .anchor {
line-height: 1.1;
}
p,
blockquote,
ul,
ol,
dl,
table,
pre {
margin-top: 0;
margin-bottom: 16px;
}
hr {
height: 4px;
padding: 0;
margin: 16px 0;
background-color: #e7e7e7;
border: 0 none;
}
ul,
ol {
padding-left: 2em;
}
ul ul,
ul ol,
ol ol,
ol ul {
margin-top: 0;
margin-bottom: 0;
}
li>p {
margin-top: 16px;
}
dl {
padding: 0;
}
dl dt {
padding: 0;
margin-top: 16px;
font-size: 1em;
font-style: italic;
font-weight: bold;
}
dl dd {
padding: 0 16px;
margin-bottom: 16px;
}
blockquote {
padding: 0 15px;
color: #777;
border-left: 4px solid #ddd;
}
blockquote>:first-child {
margin-top: 0;
}
blockquote>:last-child {
margin-bottom: 0;
}
table {
display: block;
width: 100%;
overflow: auto;
word-break: normal;
word-break: keep-all;
}
table th {
font-weight: bold;
}
table th,
table td {
padding: 6px 13px;
border: 1px solid #ddd;
}
table tr {
background-color: #fff;
border-top: 1px solid #ccc;
}
table tr:nth-child(2n) {
background-color: #f8f8f8;
}
img {
max-width: 100%;
box-sizing: content-box;
background-color: #fff;
}
code {
padding: 0;
padding-top: 0.2em;
padding-bottom: 0.2em;
margin: 0;
font-size: 85%;
background-color: rgba(0,0,0,0.04);
border-radius: 3px;
}
code:before,
code:after {
letter-spacing: -0.2em;
content: "\00a0";
}
pre>code {
padding: 0;
margin: 0;
font-size: 100%;
word-break: normal;
white-space: pre;
background: transparent;
border: 0;
}
.highlight {
margin-bottom: 16px;
}
.highlight pre,
pre {
padding: 16px;
overflow: auto;
font-size: 85%;
line-height: 1.45;
background-color: #f7f7f7;
border-radius: 3px;
}
.highlight pre {
margin-bottom: 0;
word-break: normal;
}
pre {
word-wrap: normal;
}
pre code {
display: inline;
max-width: initial;
padding: 0;
margin: 0;
overflow: initial;
line-height: inherit;
word-wrap: normal;
background-color: transparent;
border: 0;
}
pre code:before,
pre code:after {
content: normal;
}
kbd {
display: inline-block;
padding: 3px 5px;
font-size: 11px;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.pl-c {
color: #969896;
}
.pl-c1,
.pl-s .pl-v {
color: #0086b3;
}
.pl-e,
.pl-en {
color: #795da3;
}
.pl-s .pl-s1,
.pl-smi {
color: #333;
}
.pl-ent {
color: #63a35c;
}
.pl-k {
color: #a71d5d;
}
.pl-pds,
.pl-s,
.pl-s .pl-pse .pl-s1,
.pl-sr,
.pl-sr .pl-cce,
.pl-sr .pl-sra,
.pl-sr .pl-sre {
color: #183691;
}
.pl-v {
color: #ed6a43;
}
.pl-id {
color: #b52a1d;
}
.pl-ii {
background-color: #b52a1d;
color: #f8f8f8;
}
.pl-sr .pl-cce {
color: #63a35c;
font-weight: bold;
}
.pl-ml {
color: #693a17;
}
.pl-mh,
.pl-mh .pl-en,
.pl-ms {
color: #1d3e81;
font-weight: bold;
}
.pl-mq {
color: #008080;
}
.pl-mi {
color: #333;
font-style: italic;
}
.pl-mb {
color: #333;
font-weight: bold;
}
.pl-md {
background-color: #ffecec;
color: #bd2c00;
}
.pl-mi1 {
background-color: #eaffea;
color: #55a532;
}
.pl-mdr {
color: #795da3;
font-weight: bold;
}
.pl-mo {
color: #1d3e81;
}
kbd {
display: inline-block;
padding: 3px 5px;
font: 11px Consolas, "Liberation Mono", Menlo, Courier, monospace;
line-height: 10px;
color: #555;
vertical-align: middle;
background-color: #fcfcfc;
border: solid 1px #ccc;
border-bottom-color: #bbb;
border-radius: 3px;
box-shadow: inset 0 -1px 0 #bbb;
}
.task-list-item {
list-style-type: none;
}
.task-list-item+.task-list-item {
margin-top: 3px;
}
.task-list-item input {
margin: 0 0.35em 0.25em -1.6em;
vertical-align: middle;
}
:checked+.radio-label {
z-index: 1;
position: relative;
border-color: #4078c0;
}
.sourceLine {
display: inline-block;
}
code .kw { color: #000000; }
code .dt { color: #ed6a43; }
code .dv { color: #009999; }
code .bn { color: #009999; }
code .fl { color: #009999; }
code .ch { color: #009999; }
code .st { color: #183691; }
code .co { color: #969896; }
code .ot { color: #0086b3; }
code .al { color: #a61717; }
code .fu { color: #63a35c; }
code .er { color: #a61717; background-color: #e3d2d2; }
code .wa { color: #000000; }
code .cn { color: #008080; }
code .sc { color: #008080; }
code .vs { color: #183691; }
code .ss { color: #183691; }
code .im { color: #000000; }
code .va {color: #008080; }
code .cf { color: #000000; }
code .op { color: #000000; }
code .bu { color: #000000; }
code .ex { color: #000000; }
code .pp { color: #999999; }
code .at { color: #008080; }
code .do { color: #969896; }
code .an { color: #008080; }
code .cv { color: #008080; }
code .in { color: #008080; }
</style>
<style>
body {
box-sizing: border-box;
min-width: 200px;
max-width: 980px;
margin: 0 auto;
padding: 45px;
padding-top: 0px;
}
</style>


</head>

<body>

<h1 id="data-exploration">Data exploration</h1>
<p>Geovanny Risco May 27, 2023</p>
<ul>
<li><a href="#1-import-libraries" id="toc-1-import-libraries">1 Import
libraries</a></li>
<li><a href="#2-constantconfig-variables" id="toc-2-constantconfig-variables">2 Constant/Config variables</a></li>
<li><a href="#3-import-data" id="toc-3-import-data">3 Import
data</a></li>
<li><a href="#4-clean-and-prepare-data" id="toc-4-clean-and-prepare-data">4
Clean and prepare data</a>
<ul>
<li><a href="#41-args" id="toc-41-args">4.1 ARGs</a>
<ul>
<li><a href="#411-null-values-detection" id="toc-411-null-values-detection">4.1.1 Null values detection</a></li>
<li><a href="#412-outliers-detection" id="toc-412-outliers-detection">4.1.2
Outliers detection</a></li>
</ul></li>
<li><a href="#42-feature-engineering" id="toc-42-feature-engineering">4.2
Feature engineering</a></li>
<li><a href="#43-snps" id="toc-43-snps">4.3 SNPs</a>
<ul>
<li><a href="#431-preparation" id="toc-431-preparation">4.3.1
Preparation</a></li>
<li><a href="#432-null-values-detection" id="toc-432-null-values-detection">4.3.2 Null values detection</a></li>
<li><a href="#433-outliers-analysis" id="toc-433-outliers-analysis">4.3.3
Outliers analysis</a></li>
</ul></li>
<li><a href="#44-snps-from-card" id="toc-44-snps-from-card">4.4 SNPs
from CARD</a></li>
<li><a href="#45-filtering" id="toc-45-filtering">4.5 Filtering</a></li>
<li><a href="#46-explorationvisualization" id="toc-46-explorationvisualization">4.6
Exploration/Visualization</a></li>
<li><a href="#47-preparation" id="toc-47-preparation">4.7
Preparation</a></li>
<li><a href="#48-amr-labels" id="toc-48-amr-labels">4.8 AMR labels</a>
<ul>
<li><a href="#481-preparation" id="toc-481-preparation">4.8.1
Preparation</a></li>
<li><a href="#482-cleaning" id="toc-482-cleaning">4.8.2
Cleaning</a></li>
<li><a href="#483-exploration" id="toc-483-exploration">4.8.3
Exploration</a></li>
</ul></li>
</ul></li>
<li><a href="#5-explore-data" id="toc-5-explore-data">5 Explore
data</a></li>
<li><a href="#6-correlation-analysis" id="toc-6-correlation-analysis">6
Correlation analysis</a></li>
<li><a href="#7-save-data" id="toc-7-save-data">7 Save data</a></li>
</ul>
<h1 id="id_1-import-libraries">1 Import libraries</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## Warning: package &#39;tidyverse&#39; was built under R version 4.1.3

## -- Attaching packages --------------------------------------- tidyverse 1.3.2 --
## v ggplot2 3.4.1     v purrr   1.0.1
## v tibble  3.1.8     v dplyr   1.1.0
## v tidyr   1.3.0     v stringr 1.5.0
## v readr   2.1.4     v forcats 1.0.0

## Warning: package &#39;ggplot2&#39; was built under R version 4.1.3

## Warning: package &#39;tibble&#39; was built under R version 4.1.3

## Warning: package &#39;tidyr&#39; was built under R version 4.1.3

## Warning: package &#39;readr&#39; was built under R version 4.1.3

## Warning: package &#39;purrr&#39; was built under R version 4.1.3

## Warning: package &#39;dplyr&#39; was built under R version 4.1.3

## Warning: package &#39;stringr&#39; was built under R version 4.1.3

## Warning: package &#39;forcats&#39; was built under R version 4.1.3

## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<h1 id="id_2-constantconfig-variables">2 Constant/Config variables</h1>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>batch_number <span class="ot">&lt;-</span> <span class="st">&quot;_batch3&quot;</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>MAX_NUMBER_OF_SNPS <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>MAX_NULLS_PER_ANTIBIOTIC <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="co"># In percentage</span></span></code></pre></div>
<h1 id="id_3-import-data">3 Import data</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ARGs (Antibiotic Resistance Genes)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>args_data_filepath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/args_calling/args_table&quot;</span>, batch_number, <span class="st">&quot;.csv&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>args_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(args_data_filepath, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="st">&quot;sample_name&quot;</span> <span class="ot">=</span> <span class="fu">col_character</span>()))</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Fix/extract name of samples</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>args_data <span class="ot">&lt;-</span> args_data <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_name =</span> <span class="fu">str_extract</span>(sample_name, <span class="st">&quot;^</span><span class="sc">\\</span><span class="st">w+.</span><span class="sc">\\</span><span class="st">d+&quot;</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>args_data</span></code></pre></div>
<pre><code>## # A tibble: 6,306 x 162
##    sample_name    NarA  NarB aac(3~1 aac(3~2 aac(6~3 aac(6~4 aadA1 aadA2 aadE-~5
##    &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1 GCA_01263718~     0     0       0       0       0       0     0     0       0
##  2 GCA_01263728~     0     0       0       0       0       0     0     0       0
##  3 GCA_01263731~     0     0       0       0       0       0     0     0       0
##  4 GCA_01263738~     0     0       0       0       0       0     0     0       0
##  5 GCA_01263742~     0     0       0       0       0       0     0     0       0
##  6 GCA_01263744~     0     0       0       0       0       0     0     0       0
##  7 GCA_01263748~     0     0       0       0       0       0     0     0       0
##  8 GCA_01263786~     0     0       0       0       0       0     0     0       0
##  9 GCA_01264252~     0     0       0       0       0       0     0     0       0
## 10 GCA_01264264~     0     0       0       0       0       0     0     0       0
## # ... with 6,296 more rows, 152 more variables: `ant(2&#39;&#39;)-Ia` &lt;dbl&gt;,
## #   `ant(6)-Ia` &lt;dbl&gt;, `aph(2&#39;&#39;)-Ia` &lt;dbl&gt;, `aph(2&#39;&#39;)-Ic` &lt;dbl&gt;,
## #   `aph(2&#39;&#39;)-If` &lt;dbl&gt;, `aph(2&#39;&#39;)-Ig` &lt;dbl&gt;, `aph(3&#39;&#39;)-Ib` &lt;dbl&gt;,
## #   `aph(3&#39;)-III` &lt;dbl&gt;, `aph(3&#39;)-IIa` &lt;dbl&gt;, `aph(3&#39;)-Ia` &lt;dbl&gt;,
## #   `aph(6)-Ic` &lt;dbl&gt;, `aph(6)-Id` &lt;dbl&gt;, `blaCMY-2` &lt;dbl&gt;, `blaHERA-3` &lt;dbl&gt;,
## #   `blaOXA-184` &lt;dbl&gt;, `blaOXA-193` &lt;dbl&gt;, `blaOXA-448` &lt;dbl&gt;,
## #   `blaOXA-449` &lt;dbl&gt;, `blaOXA-450` &lt;dbl&gt;, `blaOXA-451` &lt;dbl&gt;, ...</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SNPs (Single Nucleotide Polymorphisms)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>snps_data_filepath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/variant_calling/snps_data&quot;</span>, batch_number, <span class="st">&quot;.tsv&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>snps_data <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(snps_data_filepath, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;chrom&quot;</span>, <span class="st">&quot;pos&quot;</span>, <span class="st">&quot;ref&quot;</span>, <span class="st">&quot;alt&quot;</span>, <span class="st">&quot;tgt&quot;</span>, <span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;gene_pos&quot;</span>, <span class="st">&quot;tax_id&quot;</span>, <span class="st">&quot;sample_name&quot;</span>), <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;.&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, call `problems()` on your data frame for details,
## e.g.:
##   dat &lt;- vroom(...)
##   problems(dat)

## Rows: 22136 Columns: 9
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (6): chrom, ref, alt, tgt, gene_name, sample_name
## dbl (3): pos, gene_pos, tax_id
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix/extract name of samples</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>snps_data <span class="ot">&lt;-</span> snps_data <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample_name =</span> <span class="fu">str_extract</span>(sample_name, <span class="st">&quot;^</span><span class="sc">\\</span><span class="st">w+.</span><span class="sc">\\</span><span class="st">d+&quot;</span>))</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>snps_data</span></code></pre></div>
<pre><code>## # A tibble: 22,136 x 9
##    chrom             pos ref   alt   tgt   gene_name   gene_pos tax_id sample_~1
##    &lt;chr&gt;           &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;    
##  1 NZ_KB944666.1 2170478 A     G     A/G   WMS_RS13655      234   1351 1351.853 
##  2 NZ_KB944666.1 2170481 C     T     C/T   WMS_RS13655      237   1351 1351.853 
##  3 NZ_KB944666.1 2170493 T     C     T/C   WMS_RS13655      249   1351 1351.853 
##  4 NZ_KB944666.1 2170505 T     G     T/G   WMS_RS13655      261   1351 1351.853 
##  5 NZ_KB944666.1 2170514 G     A     G/A   WMS_RS13655      270   1351 1351.853 
##  6 NZ_KB944666.1 2170548 A     G     A/G   WMS_RS13655      304   1351 1351.853 
##  7 NZ_KB944666.1 2170556 C     T     C/T   WMS_RS13655      312   1351 1351.853 
##  8 NZ_KB944666.1 2170559 T     C     T/C   WMS_RS13655      315   1351 1351.853 
##  9 NZ_KB944666.1 2170562 C     G     C/G   WMS_RS13655      318   1351 1351.853 
## 10 NZ_KB944666.1 2170571 A     G     A/G   WMS_RS13655      327   1351 1351.853 
## # ... with 22,126 more rows, and abbreviated variable name 1: sample_name</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Results from CARD database</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>card_data_filepath <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/card/card_results&quot;</span>, <span class="st">&quot;_batch1&quot;</span>, <span class="st">&quot;.tsv&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>card_data <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(card_data_filepath, <span class="at">na =</span> <span class="fu">c</span>(<span class="st">&quot;n/a&quot;</span>))</span></code></pre></div>
<pre><code>## Warning: One or more parsing issues, call `problems()` on your data frame for details,
## e.g.:
##   dat &lt;- vroom(...)
##   problems(dat)

## Rows: 8120 Columns: 27
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (16): SAMPLE_ID, ORF_ID, Contig, Orientation, Cut_Off, Best_Hit_ARO, Mod...
## dbl  (9): TAX_ID, Start, Stop, Pass_Bitscore, Best_Hit_Bitscore, Best_Identi...
## lgl  (2): Other_SNPs, Nudged
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fix/extract name of samples</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>card_data <span class="ot">&lt;-</span> card_data <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SAMPLE_ID =</span> <span class="fu">str_extract</span>(SAMPLE_ID, <span class="st">&quot;^</span><span class="sc">\\</span><span class="st">w+.</span><span class="sc">\\</span><span class="st">d+&quot;</span>))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>card_data</span></code></pre></div>
<pre><code>## # A tibble: 8,120 x 27
##    TAX_ID SAMPLE_ID  ORF_ID Contig  Start   Stop Orien~1 Cut_Off Pass_~2 Best_~3
##     &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;  &lt;chr&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1    195 GCA_00528~ AACMV~ AACMV~  40782  41555 +       Perfect     500    516.
##  2    195 GCA_00528~ AACMV~ AACMV~   1086   3005 +       Strict      300   1322.
##  3    195 GCA_00528~ AACMV~ AACMV~  22802  23575 +       Perfect     500    516.
##  4    195 GCA_00528~ AACMV~ AACMV~   1107   3026 +       Strict      300   1322.
##  5    195 GCA_00528~ AACMV~ AACMV~ 223686 226253 +       Strict     1200   1496.
##  6    195 GCA_00528~ AACMR~ AACMR~  39847  40620 +       Perfect     500    516.
##  7    195 GCA_00528~ AACMR~ AACMR~  18355  20274 +       Strict      300   1304.
##  8    195 GCA_00528~ AACMR~ AACMR~   3297   5216 +       Strict      300   1304.
##  9    195 GCA_00528~ AACMR~ AACMR~   2577   3350 +       Perfect     500    516.
## 10    197 GCA_00529~ AACNR~ AACNR~  20452  21225 -       Perfect     500    516.
## # ... with 8,110 more rows, 17 more variables: Best_Hit_ARO &lt;chr&gt;,
## #   Best_Identities &lt;dbl&gt;, ARO &lt;dbl&gt;, Model_type &lt;chr&gt;,
## #   SNPs_in_Best_Hit_ARO &lt;chr&gt;, Other_SNPs &lt;lgl&gt;, `Drug Class` &lt;chr&gt;,
## #   `Resistance Mechanism` &lt;chr&gt;, `AMR Gene Family` &lt;chr&gt;, Predicted_DNA &lt;chr&gt;,
## #   Predicted_Protein &lt;chr&gt;, CARD_Protein_Sequence &lt;chr&gt;,
## #   `Percentage Length of Reference Sequence` &lt;dbl&gt;, ID &lt;chr&gt;, Model_ID &lt;dbl&gt;,
## #   Nudged &lt;lgl&gt;, Note &lt;chr&gt;, and abbreviated variable names ...</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reference genomes (in BED format)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Loop through reference genomes folder and read BED files</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>refs_genomes_dir <span class="ot">&lt;-</span> <span class="st">&quot;data/reference_genomes&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>refs_genomes_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(refs_genomes_dir, <span class="at">pattern =</span> <span class="st">&quot;.bed&quot;</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Read each of the BED files and store them ina dictionary which key is the name of the file and the values a list of genes</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>refs_genomes <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> refs_genomes_files) {</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  tax_id <span class="ot">&lt;-</span> <span class="fu">str_remove</span>(<span class="fu">basename</span>(file), <span class="st">&quot;.bed&quot;</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  refs_genomes[tax_id] <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(file, <span class="at">col_select =</span> <span class="dv">4</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Rows: 2727 Columns: 1
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (1): WMS_RS03090
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
## Rows: 1749 Columns: 1
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (1): dcuC
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
## Rows: 1627 Columns: 1
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (1): dnaA
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
## Rows: 4672 Columns: 1
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (1): thrL
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
## Rows: 4493 Columns: 1
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (1): thrL
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AMR (Antimicrobial Resistance) labels</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>amr_labels <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/results/data_collection_ncbi/amr_labels.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="st">&quot;SampleID&quot;</span> <span class="ot">=</span> <span class="fu">col_character</span>()))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>amr_labels</span></code></pre></div>
<pre><code>## # A tibble: 6,242 x 23
##    SampleID     amikacin amoxi~1 ampic~2 cefox~3 cefti~4 ceftr~5 chlor~6 cipro~7
##    &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
##  1 SAMN04256112        0       1       1       1       1       1       0       0
##  2 SAMN04256111        0       0       0       0       0       0       0       0
##  3 SAMN04256110        0       0       0       0       0       0       0       0
##  4 SAMN04256109        0       0       0       0       0       0       0       0
##  5 SAMN04256108        0       0       0       0       0       0       0       0
##  6 SAMN04256107        0       0       1       0       0       0       0       0
##  7 SAMN04256106        0       0       0       0       0       0       0       0
##  8 SAMN04256105        0       1       1       1       1       1       0       0
##  9 SAMN04256104        0       1       1       1       1       1       0       0
## 10 SAMN04256103        0       1       1       1       1       1       0       0
## # ... with 6,232 more rows, 14 more variables: gentamicin &lt;dbl&gt;,
## #   kanamycin &lt;dbl&gt;, `nalidixic acid` &lt;dbl&gt;, streptomycin &lt;dbl&gt;,
## #   sulfisoxazole &lt;dbl&gt;, tetracycline &lt;dbl&gt;,
## #   `trimethoprim-sulfamethoxazole` &lt;dbl&gt;, sulfamethoxazole &lt;dbl&gt;,
## #   azithromycin &lt;dbl&gt;, meropenem &lt;dbl&gt;, clindamycin &lt;dbl&gt;, erythromycin &lt;dbl&gt;,
## #   florfenicol &lt;dbl&gt;, telithromycin &lt;dbl&gt;, and abbreviated variable names
## #   1: `amoxicillin-clavulanic acid`, 2: ampicillin, 3: cefoxitin, ...</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load NCBI samples metadata</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>samples_metadata <span class="ot">&lt;-</span> <span class="fu">read_tsv</span>(<span class="st">&quot;data/results/data_collection_ncbi/assembly_accession_ids+tax_ids.txt&quot;</span>, <span class="at">col_names =</span> <span class="fu">c</span>(<span class="st">&quot;biosample_accession&quot;</span>, <span class="st">&quot;assembly_accession&quot;</span>, <span class="st">&quot;tax_id&quot;</span>))</span></code></pre></div>
<pre><code>## Rows: 6208 Columns: 3
## -- Column specification --------------------------------------------------------
## Delimiter: &quot;\t&quot;
## chr (2): biosample_accession, assembly_accession
## dbl (1): tax_id
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>samples_metadata</span></code></pre></div>
<pre><code>## # A tibble: 6,208 x 3
##    biosample_accession assembly_accession tax_id
##    &lt;chr&gt;               &lt;chr&gt;               &lt;dbl&gt;
##  1 SAMN03842331        GCA_006813885.2     28901
##  2 SAMN03988294        GCA_008404065.2     28901
##  3 SAMN05596322        GCA_022569775.1     28901
##  4 SAMN04563576        GCA_020381005.1       562
##  5 SAMN04588431        GCA_008474925.2     28901
##  6 SAMN04530411        GCA_008471245.2     28901
##  7 SAMN04536994        GCA_008471305.2     28901
##  8 SAMN05440588        GCA_008524845.2     28901
##  9 SAMN04605174        GCA_008412045.2     28901
## 10 SAMN04964189        GCA_008474065.2     28901
## # ... with 6,198 more rows</code></pre>
<p>For now and until BV-BRC is active again, we will filter out 1351
samples (which are not in NCBI). In order to add BV-BRC samples, we need
to parse AMR labels information in a different way:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>amr_labels <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">SampleID</span><span class="st">`</span> <span class="sc">%in%</span> samples_metadata<span class="sc">$</span>biosample_accession)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>snps_data <span class="ot">&lt;-</span> snps_data <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample_name <span class="sc">%in%</span> samples_metadata<span class="sc">$</span>assembly_accession)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>card_data <span class="ot">&lt;-</span> card_data <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(SAMPLE_ID <span class="sc">%in%</span> samples_metadata<span class="sc">$</span>assembly_accession)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>args_data <span class="ot">&lt;-</span> args_data <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample_name <span class="sc">%in%</span> samples_metadata<span class="sc">$</span>assembly_accession)</span></code></pre></div>
<h1 id="id_4-clean-and-prepare-data">4 Clean and prepare data</h1>
<p>First of all, we will need to clean and prepare the data in order to
perform the analysis.</p>
<h2 id="id_41-args">4.1 ARGs</h2>
<p>This table has the following structure:</p>
<table>
<thead>
<tr class="header">
<th align="left">sample_name</th>
<th align="left">GeneA</th>
<th align="left">GeneB</th>
<th align="left">GeneC</th>
<th align="right">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GCA_012637185.1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="right">…</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
</tbody>
</table>
<p>For each gene, a boolean value is given dependending on whether the
gene is resistance or not.</p>
<ul>
<li>1: resistance gene</li>
<li>0: non-resistance gene</li>
</ul>
<h3 id="id_411-null-values-detection">4.1.1 Null values detection</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of nulls per sample</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nulls =</span> <span class="fu">rowSums</span>(<span class="fu">is.na</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name)))) <span class="sc">%&gt;%</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, nulls) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(nulls))</span></code></pre></div>
<pre><code>## # A tibble: 6,208 x 2
##    sample_name     nulls
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 GCA_012637185.1     0
##  2 GCA_012637285.1     0
##  3 GCA_012637315.1     0
##  4 GCA_012637385.1     0
##  5 GCA_012637425.1     0
##  6 GCA_012637445.1     0
##  7 GCA_012637485.1     0
##  8 GCA_012637865.1     0
##  9 GCA_012642525.1     0
## 10 GCA_012642645.1     0
## # ... with 6,198 more rows</code></pre>
<p>We have no nulls values for ARGs.</p>
<h3 id="id_412-outliers-detection">4.1.2 Outliers detection</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sample, how many resistance genes are present?</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name))) <span class="sc">%&gt;%</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, count) <span class="sc">%&gt;%</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span></code></pre></div>
<pre><code>## # A tibble: 6,208 x 2
##    sample_name     count
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 GCA_007758465.1    23
##  2 GCA_008551155.1    21
##  3 GCA_008477615.1    20
##  4 GCA_008469665.1    19
##  5 GCA_007194375.1    19
##  6 GCA_007742235.1    18
##  7 GCA_008478965.1    18
##  8 GCA_008552695.1    18
##  9 GCA_008474545.1    18
## 10 GCA_007763135.1    18
## # ... with 6,198 more rows</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean number of resistance genes per sample</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name))) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code></pre></div>
<pre><code>## [1] 3.627416</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot summarizing above information</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name))) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of resistance genes&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Distribution of resistance genes per sample&quot;</span>) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h2 id="id_42-feature-engineering">4.2 Feature engineering</h2>
<p>As all of the columns we have in this table is boolean data, there is
not much to do in terms of feature engineering. Hoewever, we have
noticed that there are some ARGs that does not contribute to resistance
in any sample, that is, they are always 0. Since this does not provide
us any information, we will remove them from the table.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check length of args_data columns</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>original_ncols <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">colnames</span>(args_data))</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to only columns that has any other value different than 0</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>args_data <span class="ot">&lt;-</span> args_data <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">!=</span> <span class="dv">0</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>removed_ncols <span class="ot">&lt;-</span> original_ncols <span class="sc">-</span> <span class="fu">length</span>(<span class="fu">colnames</span>(args_data))</span></code></pre></div>
<p>After the filtering, we have removed 17 columns.</p>
<h2 id="id_43-snps">4.3 SNPs</h2>
<h3 id="id_431-preparation">4.3.1 Preparation</h3>
<p>In this case, we will need to perform preparation steps for each
sample, since the table has a different structure.</p>
<table>
<thead>
<tr class="header">
<th align="left">chrom</th>
<th align="left">pos</th>
<th align="left">ref</th>
<th align="left">alt</th>
<th align="left">tgt</th>
<th align="left">gene_name</th>
<th align="left">gene_pos</th>
<th align="left">tax_id</th>
<th align="right">sample_name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">NC_002695.2</td>
<td align="left">1250767</td>
<td align="left">T</td>
<td align="left">C</td>
<td align="left">T/C</td>
<td align="left">ECs_1169</td>
<td align="left">511.0</td>
<td align="left">562</td>
<td align="right">GCA_012688215.1</td>
</tr>
<tr class="even">
<td align="left">NC_002695.2</td>
<td align="left">1250712</td>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">C/A</td>
<td align="left">ECs_1169</td>
<td align="left">456.0</td>
<td align="left">562</td>
<td align="right">GCA_012688215.1</td>
</tr>
<tr class="odd">
<td align="left">NZ_CP046317.1</td>
<td align="left">218754</td>
<td align="left">T</td>
<td align="left">G</td>
<td align="left">T/G</td>
<td align="left">FOC43_RS01045</td>
<td align="left">603</td>
<td align="left">195</td>
<td align="right">GCA_005283725.1</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
</tbody>
</table>
<p>Here is a brief description of each column:</p>
<ul>
<li>chrom: chromosome in which the SNP is located</li>
<li>pos: position of the SNP in the chromosome</li>
<li>ref: reference nucleotide (the one that is expected to be found in
the sample)</li>
<li>alt: alternative nucleotide (the one that is actually found in the
sample, that is, the mutation/SNP)</li>
<li>tgt: translated genotype, or in other words, the ref and alt
nucleotides in a single string (ref/alt). #TODO: double check this</li>
<li>gene_name: name of the gene in which the SNP is located</li>
<li>gene_pos: position of the SNP in the gene</li>
<li>tax_id: taxonomic id of the sample</li>
<li>sample_name: name of the sample</li>
</ul>
<p>Most of this information has been extracted from the VCF file
generated by the variant calling pipeline. More information about the
VCF format can be found <a href="https://samtools.github.io/hts-specs/VCFv4.2.pdf">here</a>.</p>
<p>In order to use this data for ML purposes, we need to transform it
into a table with the following structure:</p>
<p>sample_name | gene_name1/gene1_pos1 | gene_name1/gene1_pos2 |
gene_name2/gene2_pos1 | …</p>
<p>For the previous example, the table would look like this:</p>
<table>
<thead>
<tr class="header">
<th align="left">sample_name</th>
<th align="left">ECs_1169/456</th>
<th align="left">ECs_1169/1250712</th>
<th align="left">FOC43_RS01045/603</th>
<th align="right">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">GCA_012688215.1</td>
<td align="left">C</td>
<td align="left">NO-SNP</td>
<td align="left">NULL</td>
<td align="right">…</td>
</tr>
<tr class="even">
<td align="left">GCA_012637185.1</td>
<td align="left">NO-SNP</td>
<td align="left">A</td>
<td align="left">NULL</td>
<td align="right">…</td>
</tr>
<tr class="odd">
<td align="left">GCA_005283725.1</td>
<td align="left">NULL</td>
<td align="left">NULL</td>
<td align="left">G</td>
<td align="right">…</td>
</tr>
</tbody>
</table>
<p>As we can see, each SNP is represented as a column, and each row
represents a sample. For each SNP, we can have the following values:</p>
<ul>
<li>NO-SNP: no SNP found in this position of the gene, but the gene does
belong to the sample</li>
<li>NULL: the gene does not belong to the sample</li>
<li>A, C, G, T: the SNP found in this position of the gene</li>
</ul>
<p>In addition, we will encode these values into numerical values so
that we do limit the number of ML algorithms we can use. But before
that, let’s do some sanity checks.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out SNPs with no gene name (which are the same as sample with non gene_pos)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>snps_data <span class="ot">&lt;-</span> snps_data <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(gene_name))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter out SNPS which count for &gt;5 in the same gene (this is considered an anomaly, due to reference genome, etc.) #TODO: double check this</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>snps_data <span class="ot">&lt;-</span> snps_data <span class="sc">%&gt;%</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_name, gene_name) <span class="sc">%&gt;%</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(count <span class="sc">&lt;=</span> MAX_NUMBER_OF_SNPS) <span class="sc">%&gt;%</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count)</span></code></pre></div>
<p>Pivot table with above specifications:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="ot">&lt;-</span> snps_data <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, gene_name, gene_pos, alt) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">&quot;gene_pos&quot;</span>), <span class="at">values_from =</span> alt, <span class="at">values_fill =</span> <span class="st">&quot;NO-SNP&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(sample_name, gene_name), <span class="at">names_to =</span> <span class="st">&quot;gene_pos&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;alt&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="fu">c</span>(<span class="st">&quot;gene_name&quot;</span>, <span class="st">&quot;gene_pos&quot;</span>), <span class="at">values_from =</span> alt, <span class="at">values_fill =</span> <span class="st">&quot;NULL&quot;</span>, <span class="at">names_sep =</span> <span class="st">&quot;/&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<p>Now we will encode the values into numerical values. We will use the
following encoding:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>snp_2_num <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NULL&quot;</span> <span class="ot">=</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;NO-SNP&quot;</span> <span class="ot">=</span> <span class="dv">0</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;A&quot;</span> <span class="ot">=</span> <span class="dv">1</span>,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;C&quot;</span> <span class="ot">=</span> <span class="dv">2</span>,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;G&quot;</span> <span class="ot">=</span> <span class="dv">3</span>,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">&quot;T&quot;</span> <span class="ot">=</span> <span class="dv">4</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mutate all except sample_name</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="ot">&lt;-</span> snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">-</span><span class="fu">c</span>(sample_name), <span class="sc">~</span> <span class="fu">as.numeric</span>(snp_2_num[.x])))</span></code></pre></div>
<h3 id="id_432-null-values-detection">4.3.2 Null values detection</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count number of nulls per sample in percentage</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nulls =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name) <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span>) <span class="sc">/</span> <span class="fu">ncol</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name)) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, nulls) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(nulls))</span></code></pre></div>
<pre><code>## # A tibble: 114 x 2
##    sample_name     nulls
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 GCA_005287105.1  98.0
##  2 GCA_012687565.1  98.0
##  3 GCA_005284005.1  98.0
##  4 GCA_012708885.1  98.0
##  5 GCA_012714385.1  98.0
##  6 GCA_012714465.1  98.0
##  7 GCA_012708785.1  98.0
##  8 GCA_005285885.1  98.0
##  9 GCA_005282525.1  98.0
## 10 GCA_005285105.1  98.0
## # ... with 104 more rows</code></pre>
<p>For most of the samples, there is very little coocurrences in terms
of SNPs.</p>
<h3 id="id_433-outliers-analysis">4.3.3 Outliers analysis</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For each sample, how many SNPs are present?</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name) <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, count) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(count))</span></code></pre></div>
<pre><code>## # A tibble: 114 x 2
##    sample_name     count
##    &lt;chr&gt;           &lt;dbl&gt;
##  1 GCA_012686285.1    37
##  2 GCA_012688045.1    33
##  3 GCA_012688215.1    25
##  4 GCA_012717195.1    24
##  5 GCA_012686445.1    21
##  6 GCA_012735855.1    20
##  7 GCA_012714445.1    20
##  8 GCA_008524145.1    20
##  9 GCA_012642525.1    18
## 10 GCA_005289765.1    17
## # ... with 104 more rows</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Mean number of SNPs per sample</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name) <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">mean</span>(count)) <span class="sc">%&gt;%</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>()</span></code></pre></div>
<pre><code>## [1] 5.850877</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot summarizing above information</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name) <span class="sc">&gt;</span> <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of SNPs&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Distribution of SNPs per sample&quot;</span>) <span class="sc">+</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h2 id="id_44-snps-from-card">4.4 SNPs from CARD</h2>
<p>Although <a href="https://card.mcmaster.ca/">CARD database</a> offers
us a large variety of information about AMR vectors, we will only use
the SNPs information. For more information about the output format,
please refer to the official <a href="https://github.com/arpcard/rgi#id72">documentation</a>.</p>
<h2 id="id_45-filtering">4.5 Filtering</h2>
<p>We will be filtering by the following criteria: * Column
<code>Model_type</code> must be either
<code>protein variant model</code> or
<code>protein overexpression model</code> * They must have a value
within the column <code>SNPs_in_Best_Hit_ARO</code>. NOTE: this column
can have multiple values separated by commas.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by Model_type</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>card_snps_data <span class="ot">&lt;-</span> card_data <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Model_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;protein variant model&quot;</span>, <span class="st">&quot;protein overexpression model&quot;</span>))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter by SNPs_in_Best_Hit_ARO</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>card_snps_data <span class="ot">&lt;-</span> card_snps_data <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(SNPs_in_Best_Hit_ARO))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Explode SNPs_in_Best_Hit_ARO</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>card_snps_data <span class="ot">&lt;-</span> card_snps_data <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">SNPs_in_Best_Hit_ARO =</span> <span class="fu">strsplit</span>(SNPs_in_Best_Hit_ARO, <span class="st">&quot;,&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(SNPs_in_Best_Hit_ARO)</span></code></pre></div>
<h2 id="id_46-explorationvisualization">4.6
Exploration/Visualization</h2>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot showing how many SNPs are present in each sample</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>card_snps_data <span class="sc">%&gt;%</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_ID) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> count)) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of SNPs&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Distribution of SNPs per sample&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h2 id="id_47-preparation">4.7 Preparation</h2>
<p>Now that we have filtered the data, we will need to transform it into
a format compatible for ML algorithms, that is, a table with the
features of interest as columns and the samples as rows. In this case,
the features we are interested in are the SNPs, so we will need to pivot
the table so that each row represents a sample and each column
represents a SNP ID (column <code>SNPs_in_Best_Hit_ARO</code>). The
value of each cell will be the number of times that the SNP appears in
the sample.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot table</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>card_snps_data_wide <span class="ot">&lt;-</span> card_snps_data <span class="sc">%&gt;%</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SAMPLE_ID, SNPs_in_Best_Hit_ARO) <span class="sc">%&gt;%</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_ID, SNPs_in_Best_Hit_ARO) <span class="sc">%&gt;%</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> SNPs_in_Best_Hit_ARO, <span class="at">values_from =</span> count, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;SAMPLE_ID&#39;. You can override using the
## `.groups` argument.</code></pre>
<h2 id="id_48-amr-labels">4.8 AMR labels</h2>
<p>The structure of this table is as follows:</p>
<table>
<thead>
<tr class="header">
<th align="left">SampleID</th>
<th align="left">Antibiotic1</th>
<th align="left">Antibiotic2</th>
<th align="left">Antibiotic3</th>
<th align="right">…</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SAMN04256112</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="right">…</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="left">…</td>
<td align="right">…</td>
</tr>
</tbody>
</table>
<p>Where each column represents an antibiotic and each row represents a
sample. The values of each cell can be:</p>
<ul>
<li>0: the sample is not resistant to the antibiotic</li>
<li>1: the sample is resistant to the antibiotic</li>
</ul>
<p>One sample can be resistant to multiple antibiotics, so we can have
multiple 1s in the same row.</p>
<h3 id="id_481-preparation">4.8.1 Preparation</h3>
<p>Adapt data so it has the same sampleIds as ARGS and variant calling
data. AMR labes happens to have the biosamples accession numbers as
sampleIds, so we will need to map them to their corresponding assembly
accession ids.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Given information in samples_metadata, replace biosample_accession with assembly_accession</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>amr_labels <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(<span class="fu">distinct</span>(samples_metadata, biosample_accession, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;SampleID&quot;</span> <span class="ot">=</span> <span class="st">&quot;biosample_accession&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(<span class="st">`</span><span class="at">SampleID</span><span class="st">`</span>, tax_id)) <span class="sc">%&gt;%</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">`</span><span class="at">SampleID</span><span class="st">`</span> <span class="ot">=</span> assembly_accession) <span class="sc">%&gt;%</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(SampleID, <span class="fu">everything</span>())</span></code></pre></div>
<h3 id="id_482-cleaning">4.8.2 Cleaning</h3>
<p>We will remove those antibiotics with more than 30% of null
values.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count null values per antibiotic (each column) in percentage</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>nulls_per_antibiotic <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">SampleID</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">sum</span>(<span class="fu">is.na</span>(.x)) <span class="sc">/</span> <span class="fu">nrow</span>(amr_labels) <span class="sc">*</span> <span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;antibiotic&quot;</span>, <span class="at">value =</span> <span class="st">&quot;% of null values&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">% of null values</span><span class="st">`</span>))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(nulls_per_antibiotic)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">antibiotic</th>
<th align="right">% of null values</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sulfamethoxazole</td>
<td align="right">94.4417593</td>
</tr>
<tr class="even">
<td align="left">meropenem</td>
<td align="right">89.5762848</td>
</tr>
<tr class="odd">
<td align="left">clindamycin</td>
<td align="right">87.6752054</td>
</tr>
<tr class="even">
<td align="left">erythromycin</td>
<td align="right">87.6752054</td>
</tr>
<tr class="odd">
<td align="left">florfenicol</td>
<td align="right">87.6752054</td>
</tr>
<tr class="even">
<td align="left">telithromycin</td>
<td align="right">87.6752054</td>
</tr>
<tr class="odd">
<td align="left">amikacin</td>
<td align="right">54.8251974</td>
</tr>
<tr class="even">
<td align="left">azithromycin</td>
<td align="right">45.1909135</td>
</tr>
<tr class="odd">
<td align="left">kanamycin</td>
<td align="right">37.7315934</td>
</tr>
<tr class="even">
<td align="left">ceftiofur</td>
<td align="right">22.7646206</td>
</tr>
<tr class="odd">
<td align="left">sulfisoxazole</td>
<td align="right">17.8991461</td>
</tr>
<tr class="even">
<td align="left">streptomycin</td>
<td align="right">12.3409054</td>
</tr>
<tr class="odd">
<td align="left">trimethoprim-sulfamethoxazole</td>
<td align="right">12.3409054</td>
</tr>
<tr class="even">
<td align="left">amoxicillin-clavulanic acid</td>
<td align="right">12.3247946</td>
</tr>
<tr class="odd">
<td align="left">ampicillin</td>
<td align="right">12.3247946</td>
</tr>
<tr class="even">
<td align="left">cefoxitin</td>
<td align="right">12.3247946</td>
</tr>
<tr class="odd">
<td align="left">ceftriaxone</td>
<td align="right">12.3247946</td>
</tr>
<tr class="even">
<td align="left">chloramphenicol</td>
<td align="right">12.3247946</td>
</tr>
<tr class="odd">
<td align="left">gentamicin</td>
<td align="right">0.0161108</td>
</tr>
<tr class="even">
<td align="left">nalidixic acid</td>
<td align="right">0.0161108</td>
</tr>
<tr class="odd">
<td align="left">tetracycline</td>
<td align="right">0.0161108</td>
</tr>
<tr class="even">
<td align="left">ciprofloxacin</td>
<td align="right">0.0000000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove antibiotics with more than 30% of null values</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>antibiotics_to_remove <span class="ot">&lt;-</span> nulls_per_antibiotic <span class="sc">%&gt;%</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">% of null values</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">30</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(antibiotic)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>amr_labels <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(antibiotics_to_remove))</span></code></pre></div>
<h3 id="id_483-exploration">4.8.3 Exploration</h3>
<p>Count how many samples are resistance to each antibiotic:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>resistant_samples_per_antibiotic <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">SampleID</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="sc">~</span> <span class="fu">sum</span>(.x <span class="sc">==</span> <span class="dv">1</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> <span class="st">&quot;antibiotic&quot;</span>, <span class="at">value =</span> <span class="st">&quot;resistant samples&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(<span class="st">`</span><span class="at">resistant samples</span><span class="st">`</span>))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resistant_samples_per_antibiotic)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">antibiotic</th>
<th align="right">resistant samples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">tetracycline</td>
<td align="right">3343</td>
</tr>
<tr class="even">
<td align="left">streptomycin</td>
<td align="right">1818</td>
</tr>
<tr class="odd">
<td align="left">ampicillin</td>
<td align="right">1652</td>
</tr>
<tr class="even">
<td align="left">sulfisoxazole</td>
<td align="right">1539</td>
</tr>
<tr class="odd">
<td align="left">ceftriaxone</td>
<td align="right">759</td>
</tr>
<tr class="even">
<td align="left">amoxicillin-clavulanic acid</td>
<td align="right">753</td>
</tr>
<tr class="odd">
<td align="left">ceftiofur</td>
<td align="right">707</td>
</tr>
<tr class="even">
<td align="left">cefoxitin</td>
<td align="right">669</td>
</tr>
<tr class="odd">
<td align="left">gentamicin</td>
<td align="right">630</td>
</tr>
<tr class="even">
<td align="left">nalidixic acid</td>
<td align="right">275</td>
</tr>
<tr class="odd">
<td align="left">chloramphenicol</td>
<td align="right">204</td>
</tr>
<tr class="even">
<td align="left">ciprofloxacin</td>
<td align="right">185</td>
</tr>
<tr class="odd">
<td align="left">trimethoprim-sulfamethoxazole</td>
<td align="right">76</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bar plot with number of resistant samples per antibiotic</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>resistant_samples_per_antibiotic <span class="sc">%&gt;%</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> antibiotic, <span class="at">y =</span> <span class="st">`</span><span class="at">resistant samples</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Antibiotic&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of resistant samples&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h1 id="id_5-explore-data">5 Explore data</h1>
<p>Median number of resistant genes per antibiotic:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot with median number of resistant genes per antibiotic</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">n_args =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="sc">-</span>sample_name))) <span class="sc">%&gt;%</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name, n_args) <span class="sc">%&gt;%</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(amr_labels, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;sample_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;SampleID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(sample_name, n_args), <span class="at">names_to =</span> <span class="st">&quot;antibiotic&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;resistant&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(resistant <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> antibiotic, <span class="at">y =</span> n_args, <span class="at">color =</span> antibiotic)) <span class="sc">+</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Antibiotic&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of resistant genes&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Median number of SNPs per antibiotic:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot with median number of SNPs per antibiotic</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># In this case, SNPS can have multiple values, not only 0 and 1. We will count those with values &gt; 0 as valid SNPs conferring resistance</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>snps_data <span class="sc">%&gt;%</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sample_name) <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sample_name) <span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_snps =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(amr_labels, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;sample_name&quot;</span> <span class="ot">=</span> <span class="st">&quot;SampleID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(sample_name, n_snps), <span class="at">names_to =</span> <span class="st">&quot;antibiotic&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;resistant&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(resistant <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> antibiotic, <span class="at">y =</span> n_snps, <span class="at">color =</span> antibiotic)) <span class="sc">+</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Antibiotic&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of SNPs&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Median number of CARD SNPs per antibiotic:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot with median number of CARD SNPs per antibiotic</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>card_snps_data <span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(SAMPLE_ID) <span class="sc">%&gt;%</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n_card_snps =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(amr_labels, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;SAMPLE_ID&quot;</span> <span class="ot">=</span> <span class="st">&quot;SampleID&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(SAMPLE_ID, n_card_snps), <span class="at">names_to =</span> <span class="st">&quot;antibiotic&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;resistant&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(resistant <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> antibiotic, <span class="at">y =</span> n_card_snps, <span class="at">color =</span> antibiotic)) <span class="sc">+</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Antibiotic&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of CARD SNPs&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAABPlBMVEUAAAAAADoAAGYAOmYAOpAAZpAAZrYArPwAu9oAvnAAwasktwAzMzM6AAA6ADo6AGY6OmY6OpA6ZmY6ZrY6kJA6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmOpBmZgBmZjpmZmZmtrZmtttmtv9uTU1uTW5ubo5ubqtuq+SLk/+MqwCOTU2OTW6OTY6Obk2ObquOyP+QOgCQOjqQOmaQZgCQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rjk2r5OSr5P+2ZgC2Zjq2Zma2kDq225C22/+2/7a2/9u2//++nADIjk3I///Vdf7bkDrbkJDbtmbb25Db/7bb/9vb///higDkq27k///r6+vy8vL4dm35Yt3/Zaz/tmb/trb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////J3X01AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAc+0lEQVR4nO2dDZvbxnVGofWW0lpeyUq96ge1amwnTBtLSVuvWltZtzXbKsoqFVsna8eyzIapKBr//w8U8wHMADPADiUM7h3gPY/jJfCSIAMcDwASFzfLAWBMRv0BAOgCggLWQFDAGggKWANBAWsgKGBNqKDfOnhmIR0kjSoENyBoemlUIbgBQdNLowrBDQiaXhpVCG5A0PTSqEJwA4Kml0YVghsQNL00qhDcgKDppVGF4AYETS+NKgQ3IGh6aVQhuAFB00ujCsENCJpeGlUIbkDQ9NKoQnADgqaXRhWCGxA0vTSqENyAoOmlUYXgBgRNL40qBDcgaHppVCG4AUHTS6MKwQ0IyjH93k/5/CkxtqK5I6L3fdCZPu9MXzpzWgR9q0+YKGMbQY+I3vdBZ/q8M3255/tGFYIbELSfFIJGAoL2k0LQSEDQflIIGgkI2k8KQSMBQftJIWgkIGg/KQSNBATtJ4WgkYCg/aQQNBIQtJ8UgkYCgvaTQtBIQNB+UggaCQjaTwpBIwFB+0khaCQgaD8pBI0EBO0nhaCRgKD9pBA0EhC0nxSCRgKC9pNC0EhA0H5SCBoJCNpPCkEjAUH7SSFoJCBoPykEjQQE7SeFoJGAoP2kEDQSELSfFIJGAoL2k0LQSEDQflIIGgkI2k8KQSMBQftJIWgkIGg/KQSNBATtJ4WgkYCg/aQQNBKjEPTIz5CfCoJGYhyCej8yBB0DELSfFIJGAoL2k0LQSEDQflIIGgkI2k8KQSMBQftJIWgkIGg/KQSNBATtJ4WgkYCg/aQQNBIQtJ+UoaB/+nW+uXVe/COnyr8mCVwMMRC0n5SfoFpBj4nJyCmAoP2kEDQSELSflIGgm+Msy04K/R4XDxZi6kTu4j/PssNLaeXuLMtmeZnoSeZA0H5SekG380Werw4uNseFjuJvoaAQtJjcnc3EQ/FHPywn5YtYA0H7SekF/b/LPFdGLvLy7Kg+uT64yPO1UTeJPT0E7SelF7Rwr9jFX1PeWYLevpCjqxC0GFqtRPrKHgjaT0ov6HZ+zQyMEBSC1qEXVOq3dkdQM1mE2MWTpEfejzw1QcUAemwEFec//pMknZSTvIGg/aT0gubL4gj0V3Jfrr7qXGaz8mumWW59zZTrBF8zDZYeeT/y1AQdJxC0nxSCRgKC9pNC0EhA0H5SCBoJCNpPCkEjAUH7SSFoJCBoPykEjQQE7SeFoJGAoP2k9IK+8PNGVjCiQ9Afvrj7F1+WEyErjiw98n5+CDpyQX/7af7Hv/qDnghZcWTpkffz9yvo9evXu2JWgn43CUFf//1/WVMhK44sHeD+oNevdxvqCvrcj+e1ELSDdkFf/fxf9S7+vQI3/86d9bUf94nPOj/Tw870pjurRdDOxXi40ZFJQRvzHrSg0hZBn6v0ZQv7fmbD9AT92aeFpO27+O/cWR4VC752n/isc8x42JnedGcded937xH0RkfmG0Ef+FecHkyf+1M9hLaY6BlMw0fQ71xGLWgh5+tflmdJ7oqblqC+Y1B2gjrzRi3o63+EoN2vhaAD0H0Wj11812vHI6gsXNIPqn/an9U91/80E+zO9il17hD09S/u/mV1Iu+uOAg6HkFtWuzMgwW9it4EreGuOAialKDifiKLfPfo8yw7WYs7kOTbeXZwkS9P8tVMSFZMXju3R9DNnX8WL5GUoVrM5s5lsaTHYlLZrBauX1AtzLyteX3x4J37EFQyPUE7zuK3986FObJ87ngmJSrUXB9ebk+fnl7IZFFMfmULenyiSkXVoCdDtZjfPCr+feerSlC9cP2CamGX1tvq18s3zSCoZHqCOvPqu/jt6cWuUEv8rxCnmJL+rMT9nMrdem0EVQLmebkb1xPFC1fFsHuyMSOommtm1Hb7OpGvF2+KXbwGgtYEXWbFHt0SVEgjHsoqebFDl7fOcQUtXjerQr2YzZ3fPzq3BVVzjaDy+eZt7YUXsyCoBIJagspa+Nu+EXT58Sx8BK0W8/jOpfFRz/WMoFaCEbQJBLUElfLcOrcE1ceg5WAotNncfuIX1A7lkCuOC+TxwUH1zFvWkKqef2Hetnw9jkEtIKi9i19l4vTZFlSexZvTF/cs3ghqzsLVYtQ9cIvHH6jjSzXX2udXZ/H6+dXrd2c4iy+ZnqDT+i2+jrviICg3QSd2NVMdd8VBUAg6ABDUMBpBJ1LyUcNdcRAUgg4ABDVAUIZAUAMEZQgENUBQhkBQw2gE/RqCfgtBIeggQFADBGUIBDVAUIZAUEPqgnrumQFBa0BQAZ2g7qqHoDUgqCAtQcMqjumAoIZJCmrDzs4cgtqMWlCn7Hh7+pm4qPjKimNiIKgheUE7TpLcsuPt/PByfXBlxTE1ENSQvKDuqu8qO56LAfX8qno5aiCoYdyCNsuOxZiaLxddFcf+NxoWCGoYs6CesuN75xhBJQMI+ha3AL/hJ+S1KQnqlh1v5zPrRjWtFcfUjEJQC4+VFj5BvZ95dIK6Zcfbex+1n8VD0C4gaPf7+l+670+d8hiUPxDU+5mTFHS/i0UgaAkEtWEjaCJAUO9nhqBcgKDez5y2oC8g6LcQFIIOAgT1fmYIygUI6v3MEJQLENT7mdMW9BkE/RaCQtBBgKDezwxBuQBBvZ8ZgnIBgno/c5KCPnOBoDUgqIBOUGfe9AT13KdfoNNuQT3/gQt0+tCPTm/6cTcnBLVpEXR3Jnp1VnCsNq7YV1BvGCioN60E9aaVoN4UglrsIajrIlM7cwg6GUFV5yLZG0k+rPU6flpMPGFVbVwBQb1LTlPQjpMk3X9YCunpdcyu2rgCgnqXnKagzrxntZokdZGyaj7s9jrmVelRAUG9Sx6foLK0uNivZ1X5Ua3XcRqCbucLdWjiotcNBLVISlA1gp6WzYvdXscpCLqcifa1xUGKi143ENQiJUF1/2Hd4bg6Bi17HachaDGAinv3rH1DqF43ENQiJUHNWbwpNbZ6He/ODp4kIeh2fgJB81QFHftPnbuzk3Xx39cSu/g0BR3/xSKb42yWL71fhOl1A0EtIOgA4Gsm75IhKBcgqHfJaQv6YpyCyhtItj1PrxsIagFBB8AIKo49V62G6nUDQS0g6ABUgoqvxNS/vOh1A0EtHrSgUgjaC5Wg4ha84oum7qe3CKr/tgiq/7YIqv+2CKr/tgjqnbsfLYKGvLRNUJW2Car+tAka8r5+LCkfTlBQ/R8v+xHUM0Z2p2PcxUPQBhDUBoL2CQT1LhmCcsESNCtJ+bf4KQvqqTkckaBXoNcNBLVgJ6gzD4IqIKgNf0F3Z9mP7DrjRhkyK7CL9y553II2q+C5XQNq446gS+9/TXrdQFCLpAStlx2LYehJedmyiB6ra5U3799v/7mbhKag2/k1b3cSvW4gqAU7QTtOkpplx3oQrUpA9MX0m2NmZfFNQddZS1m0XjcQ1IKdoM68h61lx+ofXTpnCcpuZ18XdJn5rqYX6HUDQS2SEtQtOzbFx6kIWpzMtQ7wet1AUIukBG2UHac4gm6OO46P9bqBoBYpCdosO24eg8q7jBywFnTVunsX6HUDQS1SErRZdqzqjNVZvBxeV1n2wSlnQfE9qE2aguKnTghqw03QcV8scgV63UBQCwg6AJagK3WM4v9ZVq8bCGoBQQfACCpuKiJuzSTufuOi1w0EtWAr6IsxCiqvVZa/dK18PybpdQNBLSDoANSvqBejaNo3D4OgoxZUDp4QFILyoVYXLw5Bc//dw/S6gaAWbAW9OUZBxegpD0HX3h/k9bqBoBYQdADq92Y6KQZRXA+aQ1A+4It675IhKBcgqHfJSQrqaWYKQSUQ1IZOUHcFQVAJBLXhL6gqOxaP+F1e1wSCepc8bkFZXjrfAgT1Lnl8gnrKjt+/Ly9a3hyLFseq3lNfwKy7Hre1HRwSW9C1vFzZX5ak1w0EtWAnaMdJkq/s+FhWgYhiD1me9PS0KgHRXY/Vs2kxgu7O5H8t23lnGxo/Or1CUD869VwOLtCpZ90LghTsTsckqDPv5hVlx+UxqCieE32PTRFdqa4us6Oj9kuS/Ou/BaNeNxDUIilBvWXHSlDVPUP3PdZlyFJQ9Wz/2w1F/R71ElxuN0ZBvWXHSkO5p5d9jxsjKPXoKahfzSTB1UwjFLSl7Lj8c+tc9j02Zci5KUr2v91QQFDvkkcnaEvZsS44fuf+T9VJlClD1h2RqffwEHRMgo76p04IapOkoOO+WAQ3brCBoFzAL0neJUNQLvgE/W+MoGkL+mKcgi4zefuw7Ry7eAjKBuuXpIML8SPS2v9rvF43ENQCgg5A/cYN68P/bLkHuF43ENQCgg5A/WumzXFbwxy9biCoBVtBj0YsKHp1SiAoFxqC3mr7ZUuvGwhqAUEHAIJ6lwxBuQBBvUtOUtAjl1EJip86DWkK6swbk6BXoNcNBLVIT9DNXsXG3qc1Z8YuD/UJ+h8YQSFo6NMGF7Sl1FSvGwhqkZSg8uLjze0PxQ+FG9MhSXQ3VnXHu0efZ9nJOpO1c5+p65o/tKqPdS2yuZDZXNwck4agq7a6Y71uIKgFO0E7TpJU2fFXx1VJR1lgvMh13bG4OezmeKbKlA4v10Jcu/p4U73WlDDrZcXEFlSeJ7XUQet1A0Et2AnqzDtqFM2ZMiSrPE5QTO4enYuKTjFXfKNjFXdWtcpWtV2eN5YQC7sVohi3lxBUMD5BZdlxXTLtoK47tgUtlMyXi3r1sfXaalnVEuLRLPmAoJLxCdo+guq644ag1gha1SrTjqBrefgJQSWjE1SVHT8xlcb1AuPNrfPaLn7mVh8bQZslzP7P0xONfvE4BlWMTtDyLL4S1DoHl3XHi9oI+pGuTrZO2uuvpTqLX+MsXpKmoH391CmPQZngfA9aDKP4HjRNQXu7WIS1oAX/C0GnLSgnLEHlefzuzCr5+OGLT8uHet1AUAsIOgBG0PJq+qXZw39zF4J2vJatoC9GKWj1BVP14NXf/cOegvrRKVNB/YS89q0EbSHkff0LHrug7r2ZfviXf1O7+PcKdNZyA1udtgiq05Yb2Oq05Qa2Om25gW0PK6BF0JCXPmhBpc9bUGmboG/+f2R6gn7ziXsM2j0aIQ1OsYsPpF4XL9F3WH718z9A0GhpVEHfHaOg4s4i8m9p6jd3BZ/oNPYGm1oKQQOx780k76Zrd/nACBothaCB2F/Uiyura/d8hqDRUggayJ5Fc9E22NTSGIK+6wJB+9pgU0ujCOrMg6C9bbCppTSCeq+NM72PvRC3nYWgNCmjEZR372MISpMOLmh5wXJZUizqjcvex9ceV1cwlxWcZb2x6puoux9TYP+SZH5Mcom9waaWDn2SpMuOrZLiYlvbfef0hGx6XBUi69eU9ccUQFCadOgRtCqas0qKTdmbqaKTTY+lD6cX1WusvsiDUys7vvrmYdE22NTSwQUtS4XrJcXaVVOHrG9wKAuRq9fwENS+XsQl9gabWko3gpqSYu8IKpseq0JkZiNoN7E32NTSoQWtyo6tkmLfMahselwWIpev4SOo3M17b1Mfe4NNLaU7izclxaZwuKpD1rddUoXI5iyei6Dygqbt3Gdo7A02tZTsp05OFZsheI5Bu7odR9tgU0vJLhaBoEhDUlzNFAh28TQpBA0EJ0k0KWqSAsHXTDQpBA0EgtKkEDQQCEqTQtBAIChNGlXQGxC09w02tRSCBlK/wzIuFhkqhaCB4GommhSCBlL/or79qunYG2xqaQxBPfdAG5egZcNj/NQZP40iqDNvZIJ2EXuDTS2FoIFAUJqUhaDd/bZ51CI7v8Uv/AeisTfY1FK+gjKjJujy8Hfzheh66xJ7g00tHVzQ4gTjnb+pum/JQnf52OnFXXXqIi6I1zS+ZhLfNOF60AHSwc/iRcmRaBbcaK3t9uLmUhCvgaA06dAjqCja3D06d1pr68zqg8ilnFPT+B70d8JRXLAcPx1aUFHjLgRtttZ2e3Hb/ba5CSpbdeKC5SFSqhG02Vrb7cXNeQTtIPYGm1o6+EmSOQattdZ2e3FX/baJC+I1EJQmHfwkqdi5/9mj83pr7d3ZwYXTi7t2Fs9NULmL72rHHW2DTS2luFgkha89HVDVSZMOLejurN4fIxlQF0+T4nK7QCAoTYqapEBqu/i12sX7DkJjb7CppRA0EOsOy7iB7YApBA0EXzPRpBA0EAhKk0YV9PpYBZXNOrGLHyKFoIHUy459V4IqYm+wqaUQNBCUHdOkEDQQ3LiBJo0h6HWXcQnq/4peEXuDTS2NIqgzb2yC4iRpsBSCBlLfxXuvVZbE3mBTS2kFNeUexWFdeZFT68VO5qmtesQDJ0k0Kbmg+tEe1tELipOk4dKhBS0LiFWVsend9c59MYLKWs/qSmX5/HpDbv3UEKN6pn4M2n5Fa+wNNrV06LN4XUCsq4yt7ofZQjbqfHpq6o0vVTclu/5YP/WNFHs7cPMwmnTwEdQUb6iyY90/Vh+DrtQdG2ojlN2QWz/1ap96B7/F06RkgqpG29UgWnbmvqVG1jvVTRrchtzFUwNl6RMISpMSCWoabddHUNGE2x5Bmw25eYyg2MUPlxIJqkfL5jFo2YRb1Rtf6KdbDbl5HIMq/N1GY2+wqaWDnyTpXbyqMtaC7s7UxG+qc6HqLL7RkFs/9Q0Ee1s8u3jv3aJib7CppbhYJBCfoNjFx08haCAeQZcYQeOnEDQQz0lSkvX9qdEm6Jsv8YWfN18gD/A1E02KorlAIChNCkEDQV08TQpBA3FH0KX3DraxN9jU0qiCPhixoNu5/xwp9gabWgpBA2kIus5aejrE3mBTSyFoIHVBl1lbZXzsDTa1FIIGUr+ivv1ygNgbbGppDEEfuIxK0M1xe9UxBE1BUGfeqARdte7eBbE32NRSCBoIvgelSYkE7e5v3AJp8wX8kkSTpiQoKRCUJh1c0LXYM4r+xk/ev68eXOTb08+ya+fysZphNT1eLkT7RPq2xxCUJh36LF4UFa1U3dHxItdNj7fzw8v1QVX9cXhpNT1eFzNOGLQ9hqA06dAjqC7kKe/YoJoei9K4nSxGEv4WM62Gc9sfX/77OYOmnRCUJh18F7851j0Q9X1CxHW/0tplVaH0yBZ09+hXP75k0PYYgtKkFCdJqousFFQ1PRaCto2g+erjkxwj6GTToQUVB5BGUH3IuZ3Pyt7H+hjUElTcy4FB22MISpMO/lOnvFNIYdyBqHLX5cXbex+JP6LpcXkWbwTd/dNFzqDtMQSlSVlcLOK/BYJm8+eBasQFgtKk7AVdMamdhKA0KQtBUwCC0qSoSQoEgtKkEDQQCEqTQtBAIChNCkEDgaA0aVRBn0PQ3jfY1FIIGggEpUkhaCAQlCaFoIFAUJo0hqDPXSBoXxtsamkUQZ15ELS3DTa1FIIGAkFpUlpBZceZ7Eeh189Rln1CUJqUXNB9pIOg00sHF1SWHZt+Xk/n2bXHxYSanavrlVWtp2p0vMyybKbn6zKmjjsjxQOC0qRDn8WbsmPTClHXIhWzyxIQ0fRYNzrO5aX1ar6uCVl13RspFhCUJh16BDVlx3VB1WxdMyebHpfT+eqknK+fqEvthgWC0qSD7+KrsuOaoNZsMWCKQrmyfEmUHOv5sgstUYMiCEqTUpwk6Z11TVA1uxxBRdNj3ehY+GqPoBSjpwCC0qRDC6rLjuV+3OoXr2eXx5q66bEYSVdyZ187BiW59w0EpUkH/6lT7bdFF+MPTq0RdGmdxas7MV3KRsc/kXfjPKmdxZOU0UFQmhQXiwQCQWlSCBoIBKVJIWggEJQmRU1SIBCUJoWggUBQmhSCBgJBaVIIGggEpUmjCvoSgva+waaWQtBAIChNCkEDgaA0KQQNBILSpDEEfekCQfvaYFNLowjqLg6C9rXBppZC0EAgKE06tKCmMPOKEs09Cz6jA0FpUs6CBioxDBCUJh1YUNPRuGp4rKqL1YXIjdbGprsxVbGxAYLSpEOfxZvKYd3wWFcXq6vo/6fe2th0N6YqNjZAUJqUYBevK4etg0w1JR40Wxvr4jqyYmMDBKVJKQRVlcOVoLIcSfUzdlobl4JSFRsbIChNSiGoGgqrjtwL64y92dq4FJR29BRAUJqU4iy+qiEuW8Nubp2rfsYXzdbG5TOoio0NHYK++tndu5+WE7E32NTSoU+SdEdj1dtYNjyW1cULXU7cbG1cCkpVbGxoF/T1L7/MX/3tl3oq9gabWsrsYhEmrY09tAv6x78u/vXbcgiNvcGmlvISlEtrYw/dx6BiFM3z9wqG+TTToU3QN1/iFC+3++GLT8qHsUeUqaWoSQqkS9DXv6j8hKAQlIbOs/hPzUTsDTa1FIIG0i5ozU8ICkFpaBf0m7sCnMXHSSFoIPgliSaNKuj3ELT3DTa1FIIGAkFpUggaCASlSWMI+r0LBO1rg00tjSKoMw+C9rbBppZC0EAgKE06tKD6wmRvzWZXpfFVRZ6qb/JJRxxWJtr6LAhKkxIJ6uVtSuGveC0ETTUdWNCy2PiJaCH3eZadrDMx7JlC5NsfWmXG29PPZINE9wUCT9/kc1XDHLDovRsqQ1CadOizeF1sLPfIQpBZsxD5xOo4t50fXq4PfC/I/X2Tqxrmqxe9b0NlCEqTEuzitVJCCvG/wpJ6IbIukhPz5wvdQ7bxAimop2+yFjdg0Xs3VIagNCkPQWuFyPpPkUkHlwv3BUuxT/b0TdY1zAGL3ruhMgSlSXkIWitEtkbQe+ftI6ig2TfZ6pB8xaL3bqgMQWlSFoK6hcjlMejMcrAhaEvfZFnDfPWi926oDEFp0qFPknSxccO3WiGyOZHe3vvI2os3R1BP32Rdw3z1ovdvqAxBaVLWF4tYO3NyIChNCkEDgaA0KWtBOQFBaVKUfAQCQWlSCBoIBKVJ+xd0pEBQmhSCBgJBaVIIGggEpUkhaCAQlCaFoIFAUJoUggYCQWlSCBoIBKVJIWggEJQmhaCBQFCaFIIGAkFpUggaCASlSSFoIBCUJoWggUBQmhSCBgJBaVIIGggEpUkhaCAQlCaFoIFAUJoUggYCQWlSCBoIBKVJIWggEJQmhaCBQFCaFIIGAkFpUggaCASlSSFoIBCUJoWggUBQmhSCBgJBaVIIGggEpUkhaCAQlCaFoIFAUJoUggYCQWlSCBoIBKVJIWggEJQmhaCBQFCaFIIGAkFpUggaCASlSSFoIBCUJoWggUBQmhSCBgJBaVIIGggErbhx48Zw7wtBA5mAoO96cZ5244bH0OteevhUEDSQUEETxi+o8zQpaHOmX9AePtTLFnpY9LiYwAgamHpH0AHed/80qhDcgKAVgx6Dvk0aVQhuQND00qhCcAOCppdGFYIbEDS9NKoQ3ICg6aVRheAGBE0vjSoENyBoemlUIbgBQdNLowrBDQiaXhpVCG5A0PTSqEJwA4Kml0YVghsQNL00qhDcgKDppVGF4AYETS+NKgQ3IGh6aVQhuAFB00ujCsENCJpeGlUIbkDQ9NKoQnBjAjVJIGUgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBa8Yo6Co7sSf/9Ot8c+u8+EdOlX9NMuyHA/sxQkF3Zx8fXJhJraDHRMiZACMUdH3w5HhhJiFo0oxQ0OXh789mQr/Hx1m22BT/OpG7+M+z7PBSWrk7y7JZXiZ6ErBkfIJu5yf5qtjHb44LHYsHQkEhaDG5K8QtHoo/+mE5uZ0vrl4yIGB8gq6lnAv5v/LsSApaTYpniKeVCfb0jBmfoMtZXo2PtqC3L8TouhCCFkOrlaztUyrAjNEJup1nAjU+QtDkGZ2gK6lbsUNvCmom19fOsYtPhbEJKnbu6k9ppDj/8Z8k6aScBBwZm6Ab/RXo6tpjLWi+zGbl10yz3PqaKdcJvmbizNgEBSMDggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtb8P1bSLd/wJxOVAAAAAElFTkSuQmCC" /><!-- --></p>
<h1 id="id_6-correlation-analysis">6 Correlation analysis</h1>
<p>In the next section we will perform a correlation analysis between
the different variables in the dataset and the multiple antibiotics.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepate data for correlation analysis: Remove null values and sort data in same order</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>arranged_amr_labels <span class="ot">&lt;-</span> amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(SampleID)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>arranged_args_data <span class="ot">&lt;-</span> args_data <span class="sc">%&gt;%</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sample_name <span class="sc">%in%</span> arranged_amr_labels<span class="sc">$</span><span class="st">`</span><span class="at">SampleID</span><span class="st">`</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(sample_name) <span class="sc">%&gt;%</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>sample_name) <span class="sc">%&gt;%</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_if</span>(<span class="cf">function</span>(x) <span class="fu">any</span>(x <span class="sc">!=</span> <span class="dv">0</span>))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>arranged_amr_labels <span class="ot">&lt;-</span> arranged_amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="st">`</span><span class="at">SampleID</span><span class="st">`</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate correlation matrix and its p-values</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>args_correlation_matrix_coefficients <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(arranged_args_data), <span class="at">ncol =</span> <span class="fu">ncol</span>(arranged_amr_labels), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">colnames</span>(arranged_args_data), <span class="fu">colnames</span>(arranged_amr_labels)))</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>args_correlation_matrix_pvalues <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">ncol</span>(arranged_args_data), <span class="at">ncol =</span> <span class="fu">ncol</span>(arranged_amr_labels), <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="fu">colnames</span>(arranged_args_data), <span class="fu">colnames</span>(arranged_amr_labels)))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(arranged_args_data)) {</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(arranged_amr_labels)) {</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    args_correlation_matrix_coefficients[i, j] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(arranged_args_data[[i]], arranged_amr_labels[[j]])<span class="sc">$</span>estimate</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    args_correlation_matrix_pvalues[i, j] <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(arranged_args_data[[i]], arranged_amr_labels[[j]])<span class="sc">$</span>p.value</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="co">#TODO: analyze p-values to see if they are significant</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="co"># args_correlation_matrix &lt;- cor(arranged_args_data, arranged_amr_labels) # Alternative method to calculate correlation matrix with coefficients but not p-values</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="co"># heatmap of correlation matrix</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">heatmap</span>(args_correlation_matrix_coefficients,</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Antibiotics&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Antibiotic Resistance Genes (ARGs)&quot;</span>,</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Correlation Heatmap&quot;</span>,</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">100</span>),</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">key =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="at">key.title =</span> <span class="st">&quot;Correlation Coefficients&quot;</span>,</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Separate axis a bit more</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">margins =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">6</span>)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Warning in plot.window(...): &quot;key&quot; is not a graphical parameter

## Warning in plot.window(...): &quot;key.title&quot; is not a graphical parameter

## Warning in plot.xy(xy, type, ...): &quot;key&quot; is not a graphical parameter

## Warning in plot.xy(xy, type, ...): &quot;key.title&quot; is not a graphical parameter

## Warning in title(...): &quot;key&quot; is not a graphical parameter

## Warning in title(...): &quot;key.title&quot; is not a graphical parameter</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add gradient color legend</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;-1&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;1&quot;</span>),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;red&quot;</span>))(<span class="dv">3</span>),</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">&quot;Correlation Coefficient&quot;</span>,</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.8</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<h1 id="id_7-save-data">7 Save data</h1>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>snps_data_output_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/variant_calling/snps_data&quot;</span>, batch_number, <span class="st">&quot;_cleaned.tsv&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_tsv</span>(snps_data_output_path)</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>card_snps_data_output_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/card/card_snps_data&quot;</span>, <span class="st">&quot;_batch1&quot;</span>, <span class="st">&quot;_cleaned.tsv&quot;</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>card_snps_data_wide <span class="sc">%&gt;%</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_tsv</span>(card_snps_data_output_path)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>args_data_output_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/args_calling/args_data&quot;</span>, batch_number, <span class="st">&quot;_cleaned.tsv&quot;</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>args_data <span class="sc">%&gt;%</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_tsv</span>(args_data_output_path)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>amr_labels_output_path <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;data/results/data_collection_ncbi/amr_labels&quot;</span>, batch_number, <span class="st">&quot;_cleaned.tsv&quot;</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>amr_labels <span class="sc">%&gt;%</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_tsv</span>(amr_labels_output_path)</span></code></pre></div>

</body>
</html>
